// Functions
// ----------------------------------------------------

@function bg-icon($color, $size){
  $start: '<svg xmlns="http://www.w3.org/2000/svg" width="#{$size}" height="#{$size}" viewBox="-6.5 -7 30 30">';
  $end: '<path fill="#{'rgb(#{red($color)}, #{green($color)}, #{blue($color)})'}" d="M12.5 8.6L9 12.2V0H7v12.2L3.5 8.6l-1.4 1.5L8 16l5.9-5.9z"/></svg>';
  @return url('data:image/svg+xml;utf8,'+ $start + $end);
}

// Variables
// ----------------------------------------------------

$rowBtn-bg: #e6edf5;
$rowBtn-color: #6f98c7;

$rowBtn-bg--hover: #73777b;
$rowBtn-color--hover: white;

$rowBtn-fontSize: 22px;
$rowBtn-fontSize--pressed: 19px;

$rowBtnCover-fontSize: 25px;
$rowBtnCover-fontSize--pressed: 21px;

$rowBtnWarn-bg: #f5c018;
$rowBtnWarn-color: white;

$rowBtn-img: bg-icon($rowBtn-color, 34px);
$rowBtn-img--hover: bg-icon($rowBtn-color--hover, 34px);
$rowBtn-img--active: bg-icon($rowBtn-color--hover, 40px);

$rowBtnCover-img: bg-icon(white, 54px);

// Mixins
// ----------------------------------------------------

@mixin svk-btn {
  display: block !important;
  float: left;
  position: relative;
  border: 0;
  overflow: hidden;
  cursor: pointer;
  user-select: none;
  -webkit-font-smoothing: subpixel-antialiased;
  transition: all 80ms linear, transform .3s;

  .claimed & {
    &:hover {
      background-color: $rowBtn-bg;
    }
    &::after {
      display: none;
    }
  }

  &.--error {
    &::before {
      transform: translateX(0);
    }
    &::after {
      transform: translateX(100%);
    }
  }
}

@mixin svk-btn--row {
  width: 34px;
  height: 34px;
  margin-right: 5px;
  border-radius: 2px;
}

@mixin svk-pseudo-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transition: all 80ms linear, transform .3s;
}

// ----------------------------------------------------

.svk-btn {
  @include svk-btn;
  @include svk-btn--row;
  background-color: $rowBtn-bg;

  // Define icons
  // ----------------------------------------------------

  // Error icon
  &::before {
    @include svk-pseudo-icon;
    content: ':(';
    color: $rowBtnWarn-color;
    background: $rowBtnWarn-bg;
    font-size: $rowBtn-fontSize;
    transform: translateX(-100%);
  }

  // Download icon
  &::after {
    @include svk-pseudo-icon;
    content: '';
    background: $rowBtn-img no-repeat;
    background-size: 100%;
  }

  // Hover & active state
  // ----------------------------------------------------

  &:hover {
    background-color: $rowBtn-bg--hover;
    &::after {
      background: $rowBtn-img--hover no-repeat;
    }
  }

  &:active {
    &::after {
      transition: none;
      box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.4);
    }
  }
}

.audio_page_player__cover {
  @include svk-btn;

  .audio_layer_container &,
  .audio_layer_container &::after {
    border-radius: 0 !important;
  }

  // Define icons
  // ----------------------------------------------------

  // Error icon
  &::before {
    @include svk-pseudo-icon;
    content: ':(';
    color: $rowBtnWarn-color;
    background: $rowBtnWarn-bg;
    font-size: $rowBtnCover-fontSize;
    transform: translateX(-100%);
  }

  // Download icon
  &::after {
    @include svk-pseudo-icon;
    content: '';
    opacity: 0;
    border-radius: 2px 0 0 2px;
    background: rgba(0, 0, 0, 0.4) $rowBtnCover-img 50% 50% no-repeat;
    background-size: 80%;
  }

  // Hover & active state
  // ----------------------------------------------------

  &:hover {
    &::after {
      opacity: 1;
    }
  }

  &:active {
    &::after {
      transition: none;
      box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.4);
    }
  }
}

// Overrides
// ----------------------------------------------------

// Fix progress line left
.audio_inline_player {
  left: 39px + 34px + 5px !important;
}

// Imitate loaded svk btn
.audio_row_cover_wrap {
  $coverWidth: 34px;
  $coverMargin: 5px;

  margin-right: $coverWidth + $coverMargin * 2 !important;
  overflow: inherit !important;

  &::after {
    @include svk-pseudo-icon;
    content: '';
    cursor: progress;
    position: absolute;
    left: $coverWidth + $coverMargin;
    background: $rowBtn-bg $rowBtn-img no-repeat;
    background-size: 100%;
  }

  .svk-btn-added & {
    margin-right: $coverMargin !important;
    overflow: hidden !important;
  }
}